title: Home
background: var(--background-image)
views:
  - path: main
    title: Main
    icon: mdi:home
    badges:
      - entity: binary_sensor.updater
      - entity: binary_sensor.motion_detected
      - entity: person.pieter_rautenbach
      - entity: person.rouve_rautenbach
      - entity: binary_sensor.electricity_feed
      - entity: binary_sensor.internet_connection
    cards:
      - type: vertical-stack
        cards:
          - type: horizontal-stack
            title: Entertainment
            cards:
              - type: custom:button-card
                entity: script.entertainment_apple_tv_on
                size: 20%
                show_name: false
                tap_action:
                  action: call-service
                  haptic: light
                  service: script.turn_on
                  service_data:
                    entity_id: script.entertainment_apple_tv_on
              - type: custom:button-card
                entity: script.entertainment_satellite_on
                size: 20%
                show_name: false
                tap_action:
                  action: call-service
                  haptic: light
                  service: script.turn_on
                  service_data:
                    entity_id: script.entertainment_satellite_on
              - type: custom:button-card
                entity: script.entertainment_off
                size: 20%
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.entertainment_off
          - type: horizontal-stack
            title: Main Bedroom
            cards:
              # todo: light profiles
              - type: custom:button-card
                name: Pieter
                entity: light.smart_bulb_1
                size: 20%
                color: var(--button-card-light-color)
                show_label: true
                label: >
                  [[[
                    var b = states['light.smart_bulb_1'].attributes.brightness;
                    return parseInt(b ? b/2.55 : '0') + '%';
                  ]]]
                styles:
                  name:
                    - color: var(--paper-item-icon-color)
                  label:
                    - color: var(--paper-item-icon-color)
                    - padding-left: 1ex
                  card:
                    - font-size: 12px
                  grid:
                    - grid-template-areas: '"l" "i" "n"'
                    - grid-template-rows: min-content 1fr min-content
                    - grid-template-columns: 1fr
                tap_action:
                  action: toggle
                  haptic: light
                hold_action:
                  action: more-info
                  haptic: selection
              - type: custom:button-card
                name: Tivoli
                entity: switch.smart_plug_1
                size: 20%
                show_label: true
                # the label plus the label colour is a hack to create a phantom space
                label: >
                  [[[
                    return '_';
                  ]]]
                styles:
                  name:
                    - color: var(--paper-item-icon-color)
                  label:
                    - color: var(--primary-background-color)
                  card:
                    - font-size: 12px
                  grid:
                    - grid-template-areas: '"l" "i" "n"'
                    - grid-template-rows: min-content 1fr min-content
                    - grid-template-columns: 1fr
                tap_action:
                  action: toggle
                  haptic: light
                hold_action:
                  action: more-info
                  haptic: selection
              - type: custom:button-card
                name: Rouvé
                entity: light.smart_bulb_2
                size: 20%
                color: var(--button-card-light-color)
                show_label: true
                label: >
                  [[[
                    var b = states['light.smart_bulb_2'].attributes.brightness;
                    return parseInt(b ? b/2.55 : '0') + '%';
                  ]]]
                styles:
                  name:
                    - color: var(--paper-item-icon-color)
                  label:
                    - color: var(--paper-item-icon-color)
                    - padding-left: 1ex
                  card:
                    - font-size: 12px
                  grid:
                    - grid-template-areas: '"l" "i" "n"'
                    - grid-template-rows: min-content 1fr min-content
                    - grid-template-columns: 1fr
                tap_action:
                  action: toggle
                  haptic: light
                hold_action:
                  action: more-info
                  haptic: selection
          - type: entities
            entities:
              - entity: switch.living_room_lamp
                state_color: true
              - switch.shelly1_b961d2_relay_0
              # - light.smart_bulb_3
              # - light.smart_bulb_4
            title: Lights
            show_header_toggle: true
          - type: entities
            title: Electricity Consumption
            show_header_toggle: false
            entities:
              - entity: sensor.daily_power_consumption
                name: Today
                icon: mdi:power-plug
              - entity: sensor.monthly_power_consumption
                name: This Month
                icon: mdi:power-plug
            footer:
              type: custom:mini-graph-card
              entities:
                - entity: sensor.current_power
              hours_to_show: 24
              hour24: true
              smoothing: true
              points_per_hour: 12  # every 5 min
              line_width: 2
              line_color: '#e74c3c'
              show:
                extrema: true
                name: false
                icon: false
                average: true
                state: true
          - type: entities
            title: Clocks
            show_header_toggle: false
            entities:
              - sensor.cape_town
              - sensor.san_francisco
              - sensor.london
      - type: vertical-stack
        cards:
          - type: horizontal-stack
            title: "Entry & Access"
            cards:
              - type: custom:button-card
                name: Rouvé
                entity: cover.lhs_garage_door
                size: 20%
                show_name: true
                color_type: icon
                color: var(--paper-item-icon-color)
                state:
                  - operator: template
                    value: >
                      [[[
                        return states['binary_sensor.lhs_garage_occupied'].state == 'on'
                      ]]]
                    color: var(--paper-item-icon-active-color)
                  - operator: template
                    value: >
                      [[[
                        return states['binary_sensor.lhs_garage_occupied'].state == 'off'
                      ]]]
                    color: var(--paper-item-icon-color)
                custom_fields:
                  t:
                    card:
                      type: custom:button-card
                      name: Timer
                      entity: timer.lhs_garage_door_timer
                      show_name: false
                      show_icon: false
                      show_state: true
                      styles:
                        card:
                          - font-size: 12px
                          - box-shadow: none
                        state:
                          - margin-top: -1ex
                          - margin-bottom: -1ex
                          - color: >
                              [[[
                                if (states['timer.lhs_garage_door_timer'].state == 'idle')
                                  return "var(--paper-item-icon-color)";
                                else
                                  return "red";
                              ]]]
                styles:
                  name:
                    - color: var(--paper-item-icon-color)
                  card:
                    - font-size: 12px
                  grid:
                    - grid-template-areas: '"t" "i" "n"'
                    - grid-template-rows: min-content 1fr min-content
                    - grid-template-columns: 1fr
                tap_action:
                  action: toggle
                  haptic: light
                double_tap_action:
                  action: call-service
                  haptic: medium
                  service: script.close_garage_door_and_main_gate
                  service_data:
                    garage_door: "[[[ return entity.entity_id; ]]]"
                hold_action:
                  action: more-info
                  haptic: selection
              - type: custom:button-card
                name: Gate
                entity: cover.main_gate
                size: 20%
                show_name: true
                color_type: icon
                color: var(--paper-item-icon-color)
                custom_fields:
                  t:
                    card:
                      type: custom:button-card
                      name: Timer
                      entity: timer.main_gate_timer
                      show_name: false
                      show_icon: false
                      show_state: true
                      styles:
                        card:
                          - font-size: 12px
                          - box-shadow: none
                        state:
                          - margin-top: -1ex
                          - margin-bottom: -1ex
                          - color: >
                              [[[
                                if (states['timer.main_gate_timer'].state == 'idle')
                                  return "var(--paper-item-icon-color)";
                                else
                                  return "red";
                              ]]]
                styles:
                  name:
                    - color: var(--paper-item-icon-color)
                  card:
                    - font-size: 12px
                  grid:
                    - grid-template-areas: '"t" "i" "n"'
                    - grid-template-rows: min-content 1fr min-content
                    - grid-template-columns: 1fr
                tap_action:
                  action: toggle
                  haptic: light
                double_tap_action:
                  action: call-service
                  haptic: medium
                  service: script.turn_on
                  service_data:
                    entity_id: script.open_pedestrian_gap
                hold_action:
                  action: more-info
                  haptic: selection
              - type: custom:button-card
                name: Pieter
                entity: cover.rhs_garage_door
                size: 20%
                show_name: true
                color_type: icon
                color: var(--paper-item-icon-color)
                state:
                  - operator: template
                    value: >
                      [[[
                        return states['binary_sensor.rhs_garage_occupied'].state == 'on'
                      ]]]
                    color: var(--paper-item-icon-active-color)
                  - operator: template
                    value: >
                      [[[
                        return states['binary_sensor.rhs_garage_occupied'].state == 'off'
                      ]]]
                    color: var(--paper-item-icon-color)
                custom_fields:
                  t:
                    card:
                      type: custom:button-card
                      name: Timer
                      entity: timer.rhs_garage_door_timer
                      show_name: false
                      show_icon: false
                      show_state: true
                      styles:
                        card:
                          - font-size: 12px
                          - box-shadow: none
                        state:
                          - margin-top: -1ex
                          - margin-bottom: -1ex
                          - color: >
                              [[[
                                if (states['timer.rhs_garage_door_timer'].state == 'idle')
                                  return "var(--paper-item-icon-color)";
                                else
                                  return "red";
                              ]]]
                styles:
                  name:
                    - color: var(--paper-item-icon-color)
                  card:
                    - font-size: 12px
                  grid:
                    - grid-template-areas: '"t" "i" "n"'
                    - grid-template-rows: min-content 1fr min-content
                    - grid-template-columns: 1fr
                tap_action:
                  action: toggle
                  haptic: light
                double_tap_action:
                  action: call-service
                  haptic: medium
                  service: script.close_garage_door_and_main_gate
                  service_data:
                    # https://community.home-assistant.io/t/problem-passing-variable-from-automation-to-script/134989/5
                    # https://community.home-assistant.io/t/lovelace-button-card/65981/1063
                    # https://community.home-assistant.io/t/tap-action-script-variable/124023
                    # https://community.home-assistant.io/t/passing-a-variable-to-a-script-in-lovelace-with-entity-button/155935
                    # https://community.home-assistant.io/t/passing-variable-from-entity-button-script-shell-command/178570
                    garage_door: "[[[ return entity.entity_id; ]]]"
                hold_action:
                  action: more-info
                  haptic: selection
          - type: history-graph
            title: Who's Home?
            hours_to_show: 24
            entities:
              - entity: binary_sensor.anybody_home
                name: Anybody
              - entity: binary_sensor.pieter_present
                name: Pieter
              - entity: binary_sensor.rouve_present
                name: Rouvé
              - entity: binary_sensor.contractor_mode
                name: Contractors
              - entity: switch.guest_mode
                name: Guests
          - type: entities
            title: Special Modes
            entities:
              - switch.guest_mode
              - switch.contractor_mode
            show_header_toggle: false
          - type: custom:mini-graph-card
            name: Driving – Takealot HQ to Home
            # name: Current Travel Time
            icon: mdi:briefcase-clock
            entities:
              - entity: sensor.google_travel_time_driving
            hours_to_show: 24
            hour24: true
            smoothing: true
            points_per_hour: 4  # every 15 min
            line_width: 2
            line_color: '#3498db'
            show:
              extrema: true
      - type: vertical-stack
        cards:
        - type: weather-forecast
          entity: weather.home
        - type: entities
          title: Environment
          entities:
            - sensor.ambient_temperature
            - sensor.ambient_humidity
            - sensor.ambient_pressure
          show_header_toggle: false
        - type: custom:mini-graph-card
          entities:
            - entity: sensor.ambient_temperature
          hours_to_show: 24
          hour24: true
          smoothing: true
          points_per_hour: 2  # every 30 min
          line_width: 2
          show:
            extrema: true
        - type: custom:mini-graph-card
          entities:
            - entity: sensor.sun_illuminance
          hours_to_show: 24
          hour24: true
          smoothing: true
          points_per_hour: 12  # every 5 min
          line_width: 2
          show:
            extrema: true
          color_thresholds:
            # needs to be the same as the automation's threshold to make sense
            - value: 15320
              color: '#cccccc'
            - value: 15321
              color: '#f39c12'
          color_thresholds_transition: hard
  - title: Entertainment
    path: entertainment
    icon: mdi:audio-video
    badges: []
    cards:
      - type: vertical-stack
        title: TV
        cards:
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: script.samsung_tv_power
                styles:
                  icon:
                    - color: rgb(255, 0, 0)
                show_name: false
                tap_action:
                  action: call-service
                  haptic: light
                  service: script.turn_on
                  service_data:
                    entity_id: script.samsung_tv_power
              - type: entity-button
                entity: script.samsung_tv_hdmi
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.samsung_tv_hdmi
              - type: entity-button
                entity: script.samsung_tv_picture_mode
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.samsung_tv_picture_mode
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: script.samsung_tv_hdmi2
                aspect_ratio: 3.2
                show_name: false
                icon: mdi:apple
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.samsung_tv_hdmi2
              - type: custom:button-card
                entity: script.samsung_tv_hdmi1
                aspect_ratio: 3.2
                show_name: false
                icon: mdi:set-top-box
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.samsung_tv_hdmi1
      - type: vertical-stack
        title: Audio
        cards:
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: script.hk_3380_power_on
                aspect_ratio: 3.2
                show_name: false
                styles:
                  icon:
                    - color: rgb(255, 0, 0)
                tap_action:
                  action: call-service
                  haptic: light
                  service: script.turn_on
                  service_data:
                    entity_id: script.hk_3380_power_on
              - type: custom:button-card
                entity: script.hk_3380_power_off
                aspect_ratio: 3.2
                show_name: false
                tap_action:
                  action: call-service
                  haptic: light
                  service: script.turn_on
                  service_data:
                    entity_id: script.hk_3380_power_off
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: script.hk_3380_vid1
                show_name: false
                styles:
                  grid:
                    - position: relative
                  custom_fields:
                    source:
                      - position: absolute
                      - left: 80%
                      - top: 60%
                      - height: 20px
                      - width: 20px
                custom_fields:
                  source: >
                    [[[ return `<ha-icon icon="mdi:numeric-1" style="color: #44739e;"></ha-icon>` ]]]
                tap_action:
                  action: call-service
                  haptic: light
                  service: script.turn_on
                  service_data:
                    entity_id: script.hk_3380_vid1
              - type: custom:button-card
                entity: script.hk_3380_vid2
                show_name: false
                tap_action:
                  action: call-service
                  haptic: light
                  service: script.turn_on
                  service_data:
                    entity_id: script.hk_3380_vid2
                styles:
                  grid:
                    - position: relative
                  custom_fields:
                    source:
                      - position: absolute
                      - left: 80%
                      - top: 60%
                      - height: 20px
                      - width: 20px
                custom_fields:
                  source: >
                    [[[ return `<ha-icon icon="mdi:numeric-2" style="color: #44739e;"></ha-icon>` ]]]
              - type: entity-button
                entity: script.hk_3380_dimmer
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.hk_3380_dimmer
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: script.hk_3380_vol_down
                show_name: false
                tap_action:
                  action: call-service
                  haptic: light
                  service: script.turn_on
                  service_data:
                    entity_id: script.hk_3380_vol_down
                hold_action:
                  repeat: 200
                  action: call-service
                  haptic: selection
                  service: script.turn_on
                  service_data:
                    entity_id: script.hk_3380_vol_down
                double_tap_action:
                  action: call-service
                  haptic: medium
                  service: script.turn_on
                  service_data:
                    entity_id: script.hk_3380_vol_down_minus_5
              - type: custom:button-card
                entity: script.hk_3380_vol_up
                show_name: false
                tap_action:
                  action: call-service
                  haptic: light
                  service: script.turn_on
                  service_data:
                    entity_id: script.hk_3380_vol_up
                hold_action:
                  repeat: 200
                  action: call-service
                  haptic: selection
                  service: script.turn_on
                  service_data:
                    entity_id: script.hk_3380_vol_up
                double_tap_action:
                  action: call-service
                  haptic: medium
                  service: script.turn_on
                  service_data:
                    entity_id: script.hk_3380_vol_up_plus_5
              - type: custom:button-card
                entity: script.hk_3380_mute
                show_name: false
                styles:
                  icon:
                    - color: rgb(255, 0, 0)
                tap_action:
                  action: call-service
                  haptic: light
                  service: script.turn_on
                  service_data:
                    entity_id: script.hk_3380_mute
      - type: vertical-stack
        title: Apple TV
        cards:
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: script.apple_tv_menu
                aspect_ratio: 3.2
                show_name: false
                tap_action:
                  action: call-service
                  haptic: light
                  service: script.turn_on
                  service_data:
                    entity_id: script.apple_tv_menu
              - type: custom:button-card
                entity: script.apple_tv_home
                aspect_ratio: 3.2
                show_name: false
                tap_action:
                  action: call-service
                  haptic: light
                  service: script.turn_on
                  service_data:
                    entity_id: script.apple_tv_home
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                color_type: blank-card
              - type: entity-button
                entity: script.apple_tv_up
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.apple_tv_up
              - type: custom:button-card
                color_type: blank-card
          - type: horizontal-stack
            cards:
              - type: entity-button
                entity: script.apple_tv_left
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.apple_tv_left
              - type: entity-button
                entity: script.apple_tv_ok
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.apple_tv_ok
              - type: entity-button
                entity: script.apple_tv_right
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.apple_tv_right
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                color_type: blank-card
              - type: entity-button
                entity: script.apple_tv_down
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.apple_tv_down
              - type: custom:button-card
                color_type: blank-card
          - type: horizontal-stack
            cards:
              - type: entity-button
                entity: script.apple_tv_skip_backward
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.apple_tv_skip_backward
              - type: entity-button
                entity: script.apple_tv_play_pause
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.apple_tv_play_pause
              - type: entity-button
                entity: script.apple_tv_skip_forward
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.apple_tv_skip_forward
      - type: vertical-stack
        title: Satellite
        cards:
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: script.dstv_power
                styles:
                  icon:
                    - color: rgb(255, 0, 0)
                show_name: false
                tap_action:
                  action: call-service
                  haptic: light
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_power
              - type: entity-button
                entity: script.dstv_up
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_up
              - type: entity-button
                entity: script.dstv_menu
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_menu
          - type: horizontal-stack
            cards:
              - type: entity-button
                entity: script.dstv_left
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_left
              - type: entity-button
                entity: script.dstv_ok
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_ok
              - type: entity-button
                entity: script.dstv_right
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_right
          - type: horizontal-stack
            cards:
              - type: entity-button
                entity: script.dstv_info
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_info
              - type: entity-button
                entity: script.dstv_down
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_down
              - type: entity-button
                entity: script.dstv_back
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_back
          - type: horizontal-stack
            cards:
              - type: entity-button
                entity: script.dstv_ch_minus
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_ch_minus
              - type: entity-button
                entity: script.dstv_ch_plus
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_ch_plus
              - type: entity-button
                entity: script.dstv_alt
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_alt
          - type: horizontal-stack
            cards:
              - type: entity-button
                entity: script.dstv_vol_down
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_vol_down
              - type: entity-button
                entity: script.dstv_vol_up
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_vol_up
              - type: custom:button-card
                entity: script.dstv_mute
                show_name: false
                styles:
                  icon:
                    - color: rgb(255, 0, 0)
                tap_action:
                  action: call-service
                  haptic: light
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_mute
          - type: horizontal-stack
            cards:
              - type: entity-button
                entity: script.dstv_1
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_1
              - type: entity-button
                entity: script.dstv_2
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_2
              - type: entity-button
                entity: script.dstv_3
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_3
          - type: horizontal-stack
            cards:
              - type: entity-button
                entity: script.dstv_4
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_4
              - type: entity-button
                entity: script.dstv_5
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_5
              - type: entity-button
                entity: script.dstv_6
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_6
          - type: horizontal-stack
            cards:
              - type: entity-button
                entity: script.dstv_7
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_7
              - type: entity-button
                entity: script.dstv_8
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_8
              - type: entity-button
                entity: script.dstv_9
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_9
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                color_type: blank-card
              - type: entity-button
                entity: script.dstv_0
                show_name: false
                tap_action:
                  action: call-service
                  service: script.turn_on
                  service_data:
                    entity_id: script.dstv_0
              - type: custom:button-card
                color_type: blank-card
  - title: Internet
    path: internet
    icon: mdi:server-network
    badges:
      - binary_sensor.internet
    cards:
      - type: horizontal-stack
        cards:
          - type: gauge
            entity: sensor.internet_speed_in
            min: 0
            max: 10
            severity:
              green: 0
              yellow: 4
              red: 8
          - type: gauge
            entity: sensor.internet_speed_out
            min: 0
            max: 5
            severity:
              green: 0
              yellow: 2
              red: 4
      - type: custom:mini-graph-card
        name: Traffic
        icon: mdi:pulse
        show:
          state: false
          icon: false
          extrema: true
        entities:
          - entity: sensor.internet_speed_in
          - entity: sensor.internet_speed_out
        hours_to_show: 24
        hour24: true
        smoothing: true
        points_per_hour: 12  # every 5 min
        aggregate_func: max
        line_width: 2
      - type: horizontal-stack
        cards:
          - type: glance
            title: Today
            show_name: false
            columns: 2
            entities:
              - entity: sensor.daily_internet_usage_in
                name: Today
              - entity: sensor.daily_internet_usage_out
                name: Today
          - type: glance
            title: This Month
            show_name: false
            columns: 2
            entities:
              - entity: sensor.monthly_internet_usage_in
                name: This Month
              - entity: sensor.monthly_internet_usage_out
                name: This Month
      - type: entities
        show_header_toggle: false
        entities:
          - sensor.internet_round_trip_time_avg
          - sensor.internet_round_trip_time_mdev
          - sensor.internet_packet_loss
      - type: custom:mini-graph-card
        name: Latency
        entities:
          - entity: sensor.internet_round_trip_time_avg
        hours_to_show: 24
        hour24: true
        smoothing: true
        points_per_hour: 12  # every 5 min
        line_width: 2
        show:
          extrema: true
          average: true
  - title: Security
    path: security
    icon: mdi:security
    badges: []
    cards:
      - type: picture-glance
        title: Security Camera
        camera_image: camera.security_camera
        entities:
          - binary_sensor.motion_sensor
          - entity: script.security_camera_create_snapshot
            tap_action:
              action: call-service
              service: script.turn_on
              service_data:
                entity_id: script.security_camera_create_snapshot
          - entity: script.security_camera_record_clip
            tap_action:
              action: call-service
              service: script.turn_on
              service_data:
                entity_id: script.security_camera_record_clip
          - group.security_automations
      - type: vertical-stack
        cards:
          - type: picture-glance
            title: Last Motion Captured
            camera_image: camera.security_camera_last_snapshot
            entities: []
          - type: entities
            entities:
              - entity: sensor.security_camera_last_snapshot_relative
                name: Last Motion Event
              - entity: timer.motion_timer
                name: Living Room Light Timeout
              - entity: group.security_automations
                name: Snapshots and Lights
      - type: vertical-stack
        cards:
          - type: entities
            title: Covers
            show_header_toggle: false
            entities:
              - entity: cover.main_gate
              - entity: cover.lhs_garage_door
                name: Rouvé's Garage Door Open (LHS)
              - entity: cover.rhs_garage_door
                name: Pieter's Garage Door Open (RHS)
          - type: entities
            entities:
              - entity: timer.main_gate_timer
                name: Main Gate Open Timeout
              - entity: timer.lhs_garage_door_timer
                name: Rouvé's Garage Door Open Timeout (LHS)
              - entity: timer.rhs_garage_door_timer
                name: Pieter's Garage Door Open Timeout (RHS)
          - type: history-graph
            title: Vehicles
            hours_to_show: 24
            entities:
              - entity: binary_sensor.lhs_garage_occupied
                name: Rouvé
              - entity: binary_sensor.rhs_garage_occupied
                name: Pieter
  - title: Floorplan New
    path: floorplan_new
    panel: true
    icon: mdi:floor-plan
    badges: []
    cards:
      - title: Floorplan
        type: custom:floorplan-card
        config:
          image: /local/floorplan/floorplan.svg
          log_level: error
          rules:
            - entities:
                - binary_sensor.gate_status
                - binary_sensor.lhs_garage_door_status
                - binary_sensor.rhs_garage_door_status
                - binary_sensor.lhs_garage_occupied
                - binary_sensor.rhs_garage_occupied
                - binary_sensor.motion_sensor
              states:
                - state: 'on'
                  class: 'binary-sensor-on'
                - state: 'off'
                  class: 'binary-sensor-off'
            - action:
                service: light.toggle
              element: light.living_room_lamp
              entity: light.living_room_lamp
              states:
                - state: 'on'
                  class: 'light-on'
                - state: 'off'
                  class: 'light-off'
            - action:
                service: light.toggle
              element: light.smart_bulb_1
              entity: light.smart_bulb_1
              states:
                - state: 'on'
                  class: 'light-on'
                - state: 'off'
                  class: 'light-off'
            - action:
                service: light.toggle
              element: light.smart_bulb_2
              entity: light.smart_bulb_2
              states:
                - state: 'on'
                  class: 'light-on'
                - state: 'off'
                  class: 'light-off'
          stylesheet: /local/floorplan/floorplan.css
  - title: Floorplan
    path: floorplan
    panel: true
    icon: mdi:floor-plan
    badges: []
    cards:
      - type: picture-elements
        image: /local/floorplan.svg
        elements:
          - type: state-icon
            entity: switch.living_room_lamp
            tap_action:
              action: toggle
            style:
              top: 42%
              left: 7%
          - type: state-icon
            entity: light.smart_bulb_1
            tap_action:
              action: toggle
            style:
              top: 54.5%
              left: 68%
          - type: state-icon
            entity: light.smart_bulb_2
            tap_action:
              action: toggle
            style:
              top: 60.5%
              left: 68%
          - type: state-icon
            entity: binary_sensor.lhs_garage_occupied
            style:
              top: 15%
              left: 68%
          - type: state-icon
            entity: binary_sensor.rhs_garage_occupied
            style:
              top: 15%
              left: 56%
  - title: Devices
    path: devices
    icon: mdi:devices
    badges: []
    cards:
      - type: vertical-stack
        cards:
        - type: glance
          entities:
            - entity: sensor.pieter_activity_type
              show_last_changed: true
            - entity: sensor.pieter_activity_confidence
              show_last_changed: true
            - entity: binary_sensor.pieter_driving
              show_last_changed: true
        - type: entities
          entities:
            - device_tracker.ceres
            - sensor.ceres_battery_level
            - sensor.ceres_battery_state
          title: Ceres
          show_header_toggle: false
        - type: entities
          entities:
            - device_tracker.rouve
            - sensor.rouve_battery_level
            - sensor.rouve_battery_state
          title: Rouvé
          show_header_toggle: false
      - type: vertical-stack
        cards:
          - type: map
            entities:
              - device_tracker.ceres
              - device_tracker.rouve
          - type: history-graph
            title: Lights
            hours_to_show: 24
            entities:
              - entity: light.living_room_lamp
                name: Living Room
              - entity: light.smart_bulb_1
                name: Pieter's Side
              - entity: light.smart_bulb_2
                name: Rouvé's Side
      - type: vertical-stack
        cards:
          - type: custom:mini-graph-card
            name: Server Load
            entities:
              - entity: sensor.load_1m
              - entity: sensor.load_5m
              - entity: sensor.load_15m
            hours_to_show: 24
            hour24: true
            smoothing: true
            points_per_hour: 12  # every 5 min
            line_width: 2
            show:
              extrema: true
              average: true
          - type: entities
            entities:
              - sensor.disk_use_percent
              - sensor.memory_use_percent
              - sensor.processor_use
              - sensor.load_1m
              - sensor.load_5m
              - sensor.load_15m
              - sensor.server_cpu_temp
              - sensor.network_throughput_in_wlan0
              - sensor.network_throughput_out_wlan0
              - sensor.last_boot
            title: Server
            show_header_toggle: false
          - type: entities
            title: Thor (WD Cloud Drive)
            entities:
              - sensor.thor_disk_usage
